#!/usr/bin/awk -f

function G(r,a){z=y-(u=k);for(t=sub(/./,1,z);(r[u]=a-t)&&y>=(u+=z););}
function T(e,d){y=R[k=i];for(j=G(e)k;j++<M;)if(y=R[k=j]){i?q=0:R[k]=!t
for(G(e);t&&Z<=(x=k-Z);q=t?(k-=Z)*(y-=Z):q)for(;(t=1>L[x]+e[x])*y-Z>x;
x+=z);d+=q>G(e,2);i||R[k]=y}i?B+=d:i=M;A+=!d}END{for(T(L,Z=1e2);i-->1;
)R[i]&&T();print A,B}gsub(/[,~]/,OFS=RS){R[H=$3$2$1]=$6$5$4}+H>M{M=+H}
