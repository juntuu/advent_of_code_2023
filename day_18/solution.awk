#!/usr/bin/awk -f

END{print$1RS$2}$4=$3{for(t=2;t++<9;)t<8?$3=index("123\
456789abcdef",substr($4,t,1))+16*$3:$(t%7)=((b[t]+=s=$(\
t%6))+((a[t]+=(x[t]+(x[t]+=s*((/R|0$/)-(/L|2$/))))*(y[t]\
-(y[t]+=s*((/D|1$/)-(/U|3$/)))))^2)^.5)/2+sub(/.$/,z)}/-/
